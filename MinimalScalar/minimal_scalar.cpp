#include "minimal_scalar.hpp"

inline double computeKphi(double a, double H, double k, double m, double phiDot, double phi)
{
return (pow(a,3)*pow(H,2)*(-4*pow(k,4) + 12*pow(a,2)*pow(k,2)*(2*pow(H,2) - pow(m,2) - pow(phiDot,2)) - 9*pow(a,4)*pow(m,2)*(-2*pow(H,2) + pow(m,2) + pow(phiDot,2))))/(-8*pow(H,2)*pow(k,4) + 24*pow(a,2)*pow(H,2)*pow(k,2)*(2*pow(H,2) - pow(m,2) - pow(phiDot,2)) + 3*pow(a,4)*pow(m,2)*(12*pow(H,4) + pow(phiDot,4) - 2*pow(H,2)*(3*pow(m,2) + 4*pow(phiDot,2))));
}
inline double computeKB(double a, double H, double k, double m, double phiDot, double phi)
{
return (pow(a,7)*pow(k,4)*pow(m,2)*(-12*pow(H,4) + pow(m,2)*pow(phiDot,2) + 6*pow(H,2)*(pow(m,2) + pow(phiDot,2))))/(8*pow(H,2)*pow(k,4) + 24*pow(a,2)*pow(H,2)*pow(k,2)*(-2*pow(H,2) + pow(m,2) + pow(phiDot,2)) - 3*pow(a,4)*pow(m,2)*(12*pow(H,4) + pow(phiDot,4) - 2*pow(H,2)*(3*pow(m,2) + 4*pow(phiDot,2))));
}
inline double computeMphi(double a, double H, double k, double m, double phiDot, double phi)
{
return (-2.71131697367163e-9*a*H*(9.106776619796926e6*pow(H,3)*pow(k,10) + pow(a,2)*H*pow(k,8)*(-1.092813194375631e8*pow(H,4) + H*pow(phi,5)*(-0.00014029180695847364 + 0.008978675645342313*pow(phi,6))*phiDot - 4.553388309898463e6*pow(phiDot,4) + pow(H,2)*(5.464065971878155e7*pow(m,2) - 0.0003507295173961841*pow(phi,4) + 0.04938271604938271*pow(phi,10) + 8.196098957817234e7*pow(phiDot,2))) + pow(a,4)*H*pow(k,6)*(3.2784395831268936e8*pow(H,6) + pow(H,3)*pow(phi,5)*(0.0016835016835016834 - 0.10774410774410774*pow(phi,6))*phiDot - 2.390528862696693e7*pow(m,2)*pow(phiDot,4) - 2.7320329859390777e7*pow(phiDot,6) + pow(H,4)*(-4.098049478908617e8*pow(m,2) + 0.004208754208754209*pow(phi,4) - 0.5925925925925924*pow(phi,10) - 6.556879166253787e8*pow(phiDot,2)) + H*pow(phi,5)*phiDot*(pow(m,2)*(-0.0006313131313131314 + 0.04040404040404041*pow(phi,6)) + (-0.0008417508417508417 + 0.05387205387205387*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*(1.229414843672585e8*pow(m,4) + pow(phiDot,2)*(-0.0021043771043771043*pow(phi,4) + 0.2962962962962962*pow(phi,10) + 3.0052362845329857e8*pow(phiDot,2)) + pow(m,2)*(-0.0021043771043771043*pow(phi,4) + 0.2962962962962962*pow(phi,10) + 3.756545355666232e8*pow(phiDot,2)))) + pow(a,10)*pow(m,4)*pow(phi,4)*(pow(H,7)*(-0.007102272727272727 + 1.*pow(phi,6)) + pow(H,2)*pow(m,2)*phi*(0.0003551136363636364 - 0.022727272727272728*pow(phi,6))*pow(phiDot,3) + pow(m,2)*phi*(-0.000059185606060606055 + 0.0037878787878787876*pow(phi,6))*pow(phiDot,5) + pow(H,5)*(4.668245478084764e-13*pow(phi,12) - 1.4938385529871244e-11*pow(phi,18) + pow(m,2)*(0.007102272727272727 - 0.9999999999999998*pow(phi,6)) + 0.008285984848484848*pow(phiDot,2) + pow(phi,6)*(-3.647066779753722e-15 - 1.1666666666666665*pow(phiDot,2))) + H*pow(phiDot,2)*(pow(m,2)*(2.334122739042382e-13*pow(phi,12) - 7.469192764935622e-12*pow(phi,18) + 0.0002959280303030303*pow(phiDot,2) + pow(phi,6)*(-1.823533389876861e-15 - 0.041666666666666664*pow(phiDot,2))) + pow(phiDot,2)*(1.167061369521191e-13*pow(phi,12) - 3.734596382467811e-12*pow(phi,18) + 0.0002959280303030303*pow(phiDot,2) + pow(phi,6)*(-9.117666949384304e-16 - 0.041666666666666664*pow(phiDot,2)))) + pow(H,3)*(pow(m,4)*(-0.0017755681818181818 + 0.24999999999999994*pow(phi,6)) + pow(phiDot,2)*(-4.668245478084764e-13*pow(phi,12) + 1.4938385529871244e-11*pow(phi,18) - 0.0029592803030303034*pow(phiDot,2) + pow(phi,6)*(3.647066779753722e-15 + 0.41666666666666663*pow(phiDot,2))) + pow(m,2)*(-2.334122739042382e-13*pow(phi,12) + 7.469192764935622e-12*pow(phi,18) - 0.004142992424242425*pow(phiDot,2) + pow(phi,6)*(1.823533389876861e-15 + 0.5833333333333333*pow(phiDot,2))))) + pow(a,6)*pow(k,4)*(pow(H,6)*pow(phi,5)*(-0.005050505050505051 + 0.32323232323232326*pow(phi,6))*phiDot + pow(m,2)*pow(phi,5)*(-0.000026304713804713804 + 0.0016835016835016834*pow(phi,6))*pow(phiDot,5) + pow(H,7)*(4.91765937469034e8*pow(m,2) - 0.012626262626262628*pow(phi,4) + 1.7777777777777777*pow(phi,10) + 9.83531874938068e8*pow(phiDot,2)) + pow(H,4)*pow(phi,5)*phiDot*(pow(m,2)*(0.004629629629629629 - 0.2962962962962963*pow(phi,6)) + (0.00505050505050505 - 0.3232323232323232*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*pow(phi,5)*phiDot*(pow(m,4)*(-0.0009469696969696969 + 0.0606060606060606*pow(phi,6)) + pow(m,2)*(-0.0023674242424242425 + 0.15151515151515152*pow(phi,6))*pow(phiDot,2) + (-0.0012626262626262627 + 0.08080808080808081*pow(phi,6))*pow(phiDot,4)) + pow(H,5)*(-4.91765937469034e8*pow(m,4) + pow(m,2)*(0.015782828282828284*pow(phi,4) - 2.2222222222222223*pow(phi,10) - 1.6392197915634468e9*pow(phiDot,2)) + pow(phiDot,2)*(0.012626262626262624*pow(phi,4) - 1.7777777777777775*pow(phi,10) - 1.1474538540944126e9*pow(phiDot,2))) + H*(-4.098049478908617e7*pow(m,4)*pow(phiDot,4) - 4.098049478908617e7*pow(phiDot,8) + pow(m,2)*pow(phiDot,2)*(1.0373878840188363e-13*pow(phi,16) - 3.3196412288602763e-12*pow(phi,22) + 0.00013152356902356902*pow(phi,4)*pow(phiDot,2) - 8.196098957817234e7*pow(phiDot,4) + pow(phi,10)*(-8.104592843897159e-16 - 0.018518518518518514*pow(phiDot,2)))) + pow(H,3)*(1.229414843672585e8*pow(m,6) + pow(phiDot,4)*(-0.003156565656565656*pow(phi,4) + 0.44444444444444436*pow(phi,10) + 4.098049478908617e8*pow(phiDot,2)) + pow(m,4)*(-0.004734848484848485*pow(phi,4) + 0.6666666666666666*pow(phi,10) + 5.737269270472063e8*pow(phiDot,2)) + pow(m,2)*(-1.0373878840188363e-13*pow(phi,16) + 3.3196412288602763e-12*pow(phi,22) - 0.00815446127946128*pow(phi,4)*pow(phiDot,2) + 9.152310502895911e8*pow(phiDot,4) + pow(phi,10)*(8.104592843897159e-16 + 1.1481481481481481*pow(phiDot,2))))) + pow(a,8)*pow(k,2)*pow(m,2)*(pow(H,6)*pow(phi,5)*(-0.004419191919191919 + 0.2828282828282828*pow(phi,6))*phiDot + pow(m,2)*pow(phi,5)*(-0.00007891414141414141 + 0.00505050505050505*pow(phi,6))*pow(phiDot,5) + pow(H,7)*(1.8441222655088776e8*pow(m,2) - 0.01893939393939394*pow(phi,4) + 2.666666666666666*pow(phi,10) + 9.83531874938068e8*pow(phiDot,2)) + pow(H,4)*pow(phi,5)*phiDot*(pow(m,2)*(0.003156565656565656 - 0.202020202020202*pow(phi,6)) + (0.004419191919191919 - 0.2828282828282828*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*pow(phi,5)*phiDot*(pow(m,4)*(-0.00047348484848484844 + 0.0303030303030303*pow(phi,6)) + pow(m,2)*(-0.0014204545454545455 + 0.09090909090909091*pow(phi,6))*pow(phiDot,2) + (-0.0011047979797979798 + 0.0707070707070707*pow(phi,6))*pow(phiDot,4)) + pow(H,5)*(-1.8441222655088776e8*pow(m,4) + 6.224327304113019e-13*pow(phi,16) - 1.9917847373161662e-11*pow(phi,22) + 0.020517676767676768*pow(phi,4)*pow(phiDot,2) - 1.1474538540944126e9*pow(phiDot,4) + pow(m,2)*(0.01893939393939394*pow(phi,4) - 2.666666666666666*pow(phi,10) - 1.075737988213512e9*pow(phiDot,2)) + pow(phi,10)*(-4.862755706338296e-15 - 2.888888888888889*pow(phiDot,2))) + H*pow(phiDot,2)*(-2.305152831886097e7*pow(m,4)*pow(phiDot,2) + pow(m,2)*(3.1121636520565097e-13*pow(phi,16) - 9.958923686580831e-12*pow(phi,22) + 0.0003945707070707071*pow(phi,4)*pow(phiDot,2) - 5.890946125931136e7*pow(phiDot,4) + pow(phi,10)*(-2.431377853169148e-15 - 0.05555555555555555*pow(phiDot,2))) + pow(phiDot,2)*(1.5560818260282548e-13*pow(phi,16) - 4.9794618432904155e-12*pow(phi,22) + 0.0003945707070707071*pow(phi,4)*pow(phiDot,2) - 4.098049478908617e7*pow(phiDot,4) + pow(phi,10)*(-1.215688926584574e-15 - 0.05555555555555555*pow(phiDot,2)))) + pow(H,3)*(4.610305663772194e7*pow(m,6) + pow(m,4)*(-0.004734848484848485*pow(phi,4) + 0.6666666666666665*pow(phi,10) + 2.9198602537223893e8*pow(phiDot,2)) + pow(phiDot,2)*(-6.224327304113019e-13*pow(phi,16) + 1.9917847373161662e-11*pow(phi,22) - 0.006313131313131314*pow(phi,4)*pow(phiDot,2) + 4.098049478908617e8*pow(phiDot,4) + pow(phi,10)*(4.862755706338296e-15 + 0.8888888888888888*pow(phiDot,2))) + pow(m,2)*(-3.1121636520565097e-13*pow(phi,16) + 9.958923686580831e-12*pow(phi,22) - 0.010258838383838384*pow(phi,4)*pow(phiDot,2) + 6.91545849565829e8*pow(phiDot,4) + pow(phi,10)*(2.431377853169148e-15 + 1.4444444444444442*pow(phiDot,2)))))))/pow(-0.2222222222222222*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(1.3333333333333333*pow(H,2) - 0.6666666666666666*pow(m,2) - 0.6666666666666666*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(1.*pow(H,4) + 0.08333333333333333*pow(phiDot,4) + pow(H,2)*(-0.5*pow(m,2) - 0.6666666666666666*pow(phiDot,2))),2);
}
inline double computeMB(double a, double H, double k, double m, double phiDot, double phi)
{
return (-0.3333333333333333*pow(a,5)*pow(k,4)*pow(m,2)*(pow(H,2)*pow(k,6)*(-0.8888888888888888*pow(H,4) + 0.07407407407407407*pow(m,2)*pow(phiDot,2) + pow(H,2)*(0.4444444444444444*pow(m,2) + 0.14814814814814814*pow(phiDot,2))) + pow(a,2)*pow(H,2)*pow(k,4)*(1.7777777777777777*pow(H,6) + pow(H,3)*pow(phi,5)*(1.3693520069048636e-11 - 8.763852844191127e-10*pow(phi,6))*phiDot + H*pow(m,2)*pow(phi,5)*(-2.2822533448414394e-12 + 1.4606421406985212e-10*pow(phi,6))*phiDot + 0.2222222222222222*pow(m,4)*pow(phiDot,2) + 0.37037037037037035*pow(m,2)*pow(phiDot,4) + pow(H,4)*(-4.444444444444445*pow(m,2) - 5.333333333333333*pow(phiDot,2)) + pow(H,2)*(1.7777777777777777*pow(m,4) + 2.6666666666666665*pow(m,2)*pow(phiDot,2) + 0.4444444444444444*pow(phiDot,4))) + pow(a,6)*pow(m,4)*(4.*pow(H,8) + pow(H,3)*pow(phi,5)*(-5.135070025893238e-12 + 3.2864448165716724e-10*pow(phi,6))*pow(phiDot,3) + 0.08333333333333333*pow(m,2)*pow(phiDot,6) + 0.05555555555555555*pow(phiDot,8) + pow(H,6)*(-4.*pow(m,2) - 5.333333333333333*pow(phiDot,2)) + H*pow(phi,5)*pow(phiDot,3)*(pow(m,2)*(2.567535012946619e-12 - 1.6432224082858362e-10*pow(phi,6)) + (1.7116900086310795e-12 - 1.0954816055238909e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*(1.*pow(m,4) + 2.6666666666666665*pow(m,2)*pow(phiDot,2) + 3.4444444444444446*pow(phiDot,4)) + pow(H,2)*(-0.8333333333333334*pow(m,2)*pow(phiDot,4) - 0.7777777777777778*pow(phiDot,6))) + pow(a,4)*pow(k,2)*pow(m,2)*(9.333333333333334*pow(H,8) + pow(H,5)*pow(phi,5)*(6.846760034524318e-12 - 4.3819264220955636e-10*pow(phi,6))*phiDot + H*pow(m,2)*pow(phi,5)*(1.7116900086310795e-12 - 1.0954816055238909e-10*pow(phi,6))*pow(phiDot,3) + 0.027777777777777776*pow(m,2)*pow(phiDot,6) + pow(H,6)*(-9.333333333333334*pow(m,2) - 13.555555555555555*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*(-3.423380017262159e-12 + 2.1909632110477818e-10*pow(phi,6))*phiDot*(pow(m,2) + pow(phiDot,2)) + pow(H,4)*(2.3333333333333335*pow(m,4) + 6.444444444444445*pow(m,2)*pow(phiDot,2) + 3.888888888888889*pow(phiDot,4)) + pow(H,2)*(0.16666666666666666*pow(m,4)*pow(phiDot,2) + 0.05555555555555555*pow(m,2)*pow(phiDot,4) + 0.2777777777777778*pow(phiDot,6)))))/pow(0.4444444444444444*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(-2.6666666666666665*pow(H,2) + 1.3333333333333333*pow(m,2) + 1.3333333333333333*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(-2.*pow(H,4) - 0.16666666666666666*pow(phiDot,4) + pow(H,2)*(1.*pow(m,2) + 1.3333333333333333*pow(phiDot,2))),2);
}
inline double computeL2(double a, double H, double k, double m, double phiDot, double phi)
{
return (2*pow(a,5)*H*pow(k,2)*pow(m,2)*phiDot*(-2*pow(k,2) + pow(a,2)*(6*pow(H,2) - 3*(pow(m,2) + pow(phiDot,2)))))/(-8*pow(H,2)*pow(k,4) + 24*pow(a,2)*pow(H,2)*pow(k,2)*(2*pow(H,2) - pow(m,2) - pow(phiDot,2)) + 3*pow(a,4)*pow(m,2)*(12*pow(H,4) + pow(phiDot,4) - 2*pow(H,2)*(3*pow(m,2) + 4*pow(phiDot,2))));
}
inline double computeL1(double a, double H, double k, double m, double phiDot, double phi)
{
return (1.*pow(a,5)*pow(k,2)*pow(m,2)*(pow(k,2)*(H*pow(phi,5)*(-1.7116900086310795e-12 + 1.0954816055238909e-10*pow(phi,6)) - 0.2222222222222222*pow(H,2)*phiDot - 0.1111111111111111*pow(phiDot,3)) + pow(a,2)*(pow(H,3)*pow(phi,5)*(5.135070025893238e-12 - 3.2864448165716724e-10*pow(phi,6)) - 2.*pow(H,4)*phiDot - 0.16666666666666666*pow(m,2)*pow(phiDot,3) - 0.16666666666666666*pow(phiDot,5) + H*pow(phi,5)*(-2.567535012946619e-12 + 1.6432224082858362e-10*pow(phi,6))*(pow(m,2) + pow(phiDot,2)) + pow(H,2)*(1.*pow(m,2)*phiDot + 1.3333333333333333*pow(phiDot,3)))))/(0.4444444444444444*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(-2.6666666666666665*pow(H,2) + 1.3333333333333333*pow(m,2) + 1.3333333333333333*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(-2.*pow(H,4) - 0.16666666666666666*pow(phiDot,4) + pow(H,2)*(1.*pow(m,2) + 1.3333333333333333*pow(phiDot,2))));
}
inline double computeL0(double a, double H, double k, double m, double phiDot, double phi)
{
return (-0.5*pow(a,3)*H*pow(k,2)*pow(m,2)*(0.04938271604938271*pow(H,2)*pow(k,8)*phiDot + pow(a,2)*pow(H,2)*pow(k,6)*(H*pow(phi,5)*(7.607511149471465e-13 - 4.8688071356617376e-11*pow(phi,6)) - 0.345679012345679*pow(H,2)*phiDot + 0.2222222222222222*pow(m,2)*phiDot + 0.32098765432098764*pow(phiDot,3)) + pow(a,8)*pow(m,4)*pow(phiDot,2)*(pow(H,3)*pow(phi,5)*(-5.135070025893238e-12 + 3.2864448165716724e-10*pow(phi,6)) + 1.*pow(H,4)*phiDot + 0.08333333333333333*pow(m,2)*pow(phiDot,3) + 0.027777777777777776*pow(phiDot,5) + H*pow(phi,5)*(pow(m,2)*(2.567535012946619e-12 - 1.6432224082858362e-10*pow(phi,6)) + (1.7116900086310795e-12 - 1.0954816055238909e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*(-0.5*pow(m,2)*phiDot - 0.3333333333333333*pow(phiDot,3))) + pow(a,6)*pow(k,2)*pow(m,2)*(pow(H,5)*pow(phi,5)*(-3.4233800172621587e-12 + 2.1909632110477815e-10*pow(phi,6)) + 1.1111111111111112*pow(H,6)*phiDot + 0.08333333333333333*pow(m,2)*pow(phiDot,5) + 0.06481481481481481*pow(phiDot,7) + H*pow(phi,5)*pow(phiDot,2)*(pow(m,2)*(3.4233800172621587e-12 - 2.1909632110477815e-10*pow(phi,6)) + (1.9969716767362593e-12 - 1.278061873111206e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*(pow(m,2)*(1.7116900086310793e-12 - 1.0954816055238908e-10*pow(phi,6)) + (-6.846760034524317e-12 + 4.381926422095563e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*(-0.8888888888888888*pow(m,2)*phiDot + 0.037037037037037035*pow(phiDot,3)) + pow(H,2)*(0.16666666666666666*pow(m,4)*phiDot + 0.16666666666666666*pow(m,2)*pow(phiDot,3) + 0.16666666666666666*pow(phiDot,5))) + pow(a,4)*pow(k,4)*(pow(H,3)*pow(m,2)*pow(phi,5)*(2.2822533448414394e-12 - 1.4606421406985212e-10*pow(phi,6)) + pow(H,5)*pow(phi,5)*(-4.564506689682879e-12 + 2.9212842813970424e-10*pow(phi,6)) + 0.8888888888888888*pow(H,6)*phiDot + H*pow(m,2)*pow(phi,5)*(1.1411266724207197e-12 - 7.303210703492606e-11*pow(phi,6))*pow(phiDot,2) + 0.018518518518518517*pow(m,2)*pow(phiDot,5) + pow(H,4)*(-1.1111111111111112*pow(m,2)*phiDot - 0.8888888888888888*pow(phiDot,3)) + pow(H,2)*(0.3333333333333333*pow(m,4)*phiDot + 0.8148148148148148*pow(m,2)*pow(phiDot,3) + 0.5185185185185185*pow(phiDot,5)))))/pow(-0.2222222222222222*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(1.3333333333333333*pow(H,2) - 0.6666666666666666*pow(m,2) - 0.6666666666666666*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(1.*pow(H,4) + 0.08333333333333333*pow(phiDot,4) + pow(H,2)*(-0.5*pow(m,2) - 0.6666666666666666*pow(phiDot,2))),2);
}
inline double computeDKphi(double a, double H, double k, double m, double phiDot, double phi)
{
return (pow(a,3)*H*(0.07407407407407407*pow(H,4)*pow(k,8) + pow(a,2)*pow(H,4)*pow(k,6)*(-0.8888888888888888*pow(H,2) + 0.4444444444444444*pow(m,2) + 0.4444444444444444*pow(phiDot,2)) + pow(a,4)*pow(k,4)*(2.666666666666667*pow(H,8) + pow(H,3)*pow(m,2)*pow(phi,5)*(-2.852816681051797e-13 + 1.8258026758731502e-11*pow(phi,6))*phiDot + H*pow(m,2)*pow(phi,5)*(2.8528166810517987e-13 - 1.8258026758731512e-11*pow(phi,6))*pow(phiDot,3) + 0.009259259259259259*pow(m,2)*pow(phiDot,6) + pow(H,6)*(-3.333333333333334*pow(m,2) - 2.6666666666666665*pow(phiDot,2)) + pow(H,4)*(1.*pow(m,4) + 1.7592592592592595*pow(m,2)*pow(phiDot,2) + 0.6666666666666667*pow(phiDot,4)) + pow(H,2)*(5.551115123125783e-17*pow(m,4)*pow(phiDot,2) - 0.10185185185185186*pow(m,2)*pow(phiDot,4))) + pow(a,6)*pow(k,2)*pow(m,2)*(4.*pow(H,8) + pow(H,5)*pow(phi,5)*(1.71169000863108e-12 - 1.0954816055238912e-10*pow(phi,6))*phiDot + 0.027777777777777776*pow(m,2)*pow(phiDot,6) + 0.027777777777777776*pow(phiDot,8) + pow(H,6)*(-4.*pow(m,2) - 4.777777777777777*pow(phiDot,2)) + H*pow(phi,5)*pow(phiDot,3)*(pow(m,2)*(8.558450043155396e-13 - 5.477408027619453e-11*pow(phi,6)) + (4.279225021577698e-13 - 2.7387040138097266e-11*pow(phi,6))*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*phiDot*(pow(m,2)*(-8.5584500431554e-13 + 5.477408027619456e-11*pow(phi,6)) + (-1.7116900086310783e-12 + 1.0954816055238901e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*(1.*pow(m,4) + 2.3888888888888897*pow(m,2)*pow(phiDot,2) + 1.8888888888888886*pow(phiDot,4)) + pow(H,2)*(-0.36111111111111105*pow(m,2)*pow(phiDot,4) - 0.3055555555555556*pow(phiDot,6))) + pow(a,8)*pow(m,4)*(1.5*pow(H,8) + pow(H,5)*pow(phi,5)*(1.2837675064733091e-12 - 8.216112041429179e-11*pow(phi,6))*phiDot + 0.020833333333333332*pow(m,2)*pow(phiDot,6) + 0.020833333333333332*pow(phiDot,8) + pow(H,6)*(-1.5*pow(m,2) - 2.25*pow(phiDot,2)) + H*pow(phi,5)*pow(phiDot,3)*(pow(m,2)*(6.418837532366548e-13 - 4.1080560207145906e-11*pow(phi,6)) + (3.2094187661832734e-13 - 2.054028010357295e-11*pow(phi,6))*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*phiDot*(pow(m,2)*(-6.418837532366546e-13 + 4.108056020714589e-11*pow(phi,6)) + (-1.2837675064733087e-12 + 8.216112041429176e-11*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*(0.375*pow(m,4) + 1.125*pow(m,2)*pow(phiDot,2) + 1.2083333333333333*pow(phiDot,4)) + pow(H,2)*(-0.3125*pow(m,2)*pow(phiDot,4) - 0.27083333333333337*pow(phiDot,6)))))/pow(-0.2222222222222222*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(1.3333333333333333*pow(H,2) - 0.6666666666666666*pow(m,2) - 0.6666666666666666*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(1.*pow(H,4) + 0.08333333333333333*pow(phiDot,4) + pow(H,2)*(-0.5*pow(m,2) - 0.6666666666666666*pow(phiDot,2))),2);
}
inline double computeDKB(double a, double H, double k, double m, double phiDot, double phi)
{
return (pow(a,7)*pow(k,4)*pow(m,2)*(H*pow(k,4)*(-0.5185185185185184*pow(H,6) + pow(H,3)*pow(phi,5)*(5.705633362103596e-13 - 3.651605351746302e-11*pow(phi,6))*phiDot + H*pow(m,2)*pow(phi,5)*(9.509388936839329e-14 - 6.08600891957717e-12*pow(phi,6))*phiDot + 0.006172839506172839*pow(m,2)*pow(phiDot,4) + pow(H,4)*(0.2592592592592592*pow(m,2) + 0.11111111111111108*pow(phiDot,2)) + pow(H,2)*(0.006172839506172843*pow(m,2)*pow(phiDot,2) + 6.938893903907228e-18*pow(phiDot,4))) + pow(a,2)*H*pow(k,2)*(2.222222222222222*pow(H,8) + pow(H,5)*pow(phi,5)*(4.0389678347315804e-28 - 2.5849394142282115e-26*pow(phi,6))*phiDot + 0.018518518518518517*pow(m,4)*pow(phiDot,4) + 0.018518518518518517*pow(m,2)*pow(phiDot,6) + pow(H,6)*(-2.222222222222222*pow(m,2) - 2.2222222222222214*pow(phiDot,2)) + H*pow(m,2)*pow(phi,5)*phiDot*(pow(m,2)*(2.852816681051799e-13 - 1.8258026758731515e-11*pow(phi,6)) + (5.048709793414476e-29 - 3.2311742677852644e-27*pow(phi,6))*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*phiDot*(pow(m,2)*(-5.7056333621036e-13 + 3.651605351746304e-11*pow(phi,6)) + (-2.0194839173657902e-28 + 1.2924697071141057e-26*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*(0.5555555555555555*pow(m,4) + 1.148148148148148*pow(m,2)*pow(phiDot,2) + 0.5555555555555555*pow(phiDot,4)) + pow(H,2)*(-0.018518518518518504*pow(m,4)*pow(phiDot,2) + 0.018518518518518545*pow(m,2)*pow(phiDot,4) + 1.3877787807814457e-17*pow(phiDot,6))) + pow(a,4)*pow(m,2)*(0.9999999999999998*pow(H,9) + pow(H,6)*pow(phi,5)*(8.5584500431554e-13 - 5.477408027619456e-11*pow(phi,6))*phiDot + pow(m,2)*pow(phi,5)*(3.566020851314748e-14 - 2.2822533448414386e-12*pow(phi,6))*pow(phiDot,5) + pow(H,7)*(-0.9999999999999998*pow(m,2) - 1.4999999999999996*pow(phiDot,2)) + pow(H,4)*pow(phi,5)*phiDot*(pow(m,2)*(-8.558450043155398e-13 + 5.4774080276194545e-11*pow(phi,6)) + (-8.558450043155396e-13 + 5.477408027619453e-11*pow(phi,6))*pow(phiDot,2)) + pow(H,5)*(0.24999999999999994*pow(m,4) + 0.833333333333333*pow(m,2)*pow(phiDot,2) + 0.8055555555555554*pow(phiDot,4)) + pow(H,2)*pow(phi,5)*phiDot*(pow(m,4)*(2.1396125107888492e-13 - 1.3693520069048635e-11*pow(phi,6)) + pow(m,2)*(4.279225021577699e-13 - 2.7387040138097273e-11*pow(phi,6))*pow(phiDot,2) + (2.1396125107888494e-13 - 1.3693520069048636e-11*pow(phi,6))*pow(phiDot,4)) + pow(H,3)*(-0.04166666666666666*pow(m,4)*pow(phiDot,2) - 0.20833333333333331*pow(m,2)*pow(phiDot,4) - 0.18055555555555555*pow(phiDot,6)) + H*(0.013888888888888888*pow(m,4)*pow(phiDot,4) + 0.011574074074074072*pow(m,2)*pow(phiDot,6) + 0.013888888888888886*pow(phiDot,8)))))/pow(-0.2222222222222222*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(1.3333333333333333*pow(H,2) - 0.6666666666666666*pow(m,2) - 0.6666666666666666*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(1.*pow(H,4) + 0.08333333333333333*pow(phiDot,4) + pow(H,2)*(-0.5*pow(m,2) - 0.6666666666666666*pow(phiDot,2))),2);
}
inline double computeDL2(double a, double H, double k, double m, double phiDot, double phi)
{
return (pow(a,5)*pow(k,2)*pow(m,2)*(pow(H,2)*pow(k,6)*(H*pow(phi,5)*(1.901877787367866e-13 - 1.2172017839154342e-11*pow(phi,6)) + 0.04938271604938271*pow(H,2)*phiDot + 0.012345679012345678*pow(phiDot,3)) + pow(a,2)*pow(H,2)*pow(k,4)*(pow(H,3)*pow(phi,5)*(-1.7116900086310793e-12 + 1.0954816055238908e-10*pow(phi,6)) - 0.2962962962962963*pow(H,4)*phiDot + 0.05555555555555555*pow(m,2)*pow(phiDot,3) + 0.05555555555555555*pow(phiDot,5) + H*pow(phi,5)*(pow(m,2)*(8.558450043155397e-13 - 5.477408027619454e-11*pow(phi,6)) + (2.852816681051799e-13 - 1.8258026758731515e-11*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*(0.14814814814814814*pow(m,2)*phiDot + 0.18518518518518515*pow(phiDot,3))) + pow(a,6)*pow(m,2)*(pow(H,7)*pow(phi,5)*(2.567535012946619e-12 - 1.6432224082858362e-10*pow(phi,6)) - 0.16666666666666652*pow(H,6)*pow(phiDot,3) + 0.19444444444444436*pow(H,4)*pow(phiDot,5) + 0.006944444444444444*pow(m,2)*pow(phiDot,7) + 0.006944444444444444*pow(phiDot,9) + H*pow(phi,5)*pow(phiDot,4)*(pow(m,2)*(3.209418766183274e-13 - 2.0540280103572953e-11*pow(phi,6)) + (1.069806255394425e-13 - 6.84676003452432e-12*pow(phi,6))*pow(phiDot,2)) + pow(H,5)*pow(phi,5)*(pow(m,2)*(-2.567535012946619e-12 + 1.6432224082858362e-10*pow(phi,6)) + (-2.1396125107888487e-12 + 1.3693520069048632e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*(pow(m,4)*(6.418837532366548e-13 - 4.1080560207145906e-11*pow(phi,6)) + pow(m,2)*(1.0698062553944244e-12 - 6.846760034524316e-11*pow(phi,6))*pow(phiDot,2) + (2.13961251078885e-13 - 1.369352006904864e-11*pow(phi,6))*pow(phiDot,4)) + pow(H,2)*(0.041666666666666664*pow(m,4)*pow(phiDot,3) - 0.0694444444444444*pow(m,2)*pow(phiDot,5) - 0.06944444444444443*pow(phiDot,7))) + pow(a,4)*pow(k,2)*(pow(H,7)*pow(phi,5)*(3.4233800172621587e-12 - 2.1909632110477815e-10*pow(phi,6)) + 0.8888888888888888*pow(H,8)*phiDot + H*pow(m,2)*pow(phi,5)*(2.1396125107888487e-13 - 1.3693520069048631e-11*pow(phi,6))*pow(phiDot,4) + 0.004629629629629629*pow(m,2)*pow(phiDot,7) + pow(H,5)*pow(phi,5)*(pow(m,2)*(-4.279225021577698e-12 + 2.738704013809727e-10*pow(phi,6)) + (-3.4233800172621587e-12 + 2.1909632110477815e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,6)*(-0.6666666666666667*pow(m,2)*phiDot - 0.6666666666666665*pow(phiDot,3)) + pow(H,4)*(0.11111111111111105*pow(m,4)*phiDot + 0.35185185185185186*pow(m,2)*pow(phiDot,3)) + pow(H,3)*pow(phi,5)*(pow(m,4)*(1.2837675064733095e-12 - 8.216112041429181e-11*pow(phi,6)) + pow(m,2)*(1.1411266724207197e-12 - 7.303210703492606e-11*pow(phi,6))*pow(phiDot,2) + (8.558450043155394e-13 - 5.477408027619452e-11*pow(phi,6))*pow(phiDot,4)) + pow(H,2)*(0.08333333333333333*pow(m,4)*pow(phiDot,3) + 0.05555555555555555*pow(m,2)*pow(phiDot,5) + 0.05555555555555555*pow(phiDot,7)))))/pow(-0.2222222222222222*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(1.3333333333333333*pow(H,2) - 0.6666666666666666*pow(m,2) - 0.6666666666666666*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(1.*pow(H,4) + 0.08333333333333333*pow(phiDot,4) + pow(H,2)*(-0.5*pow(m,2) - 0.6666666666666666*pow(phiDot,2))),2);
}
inline double computeDL1(double a, double H, double k, double m, double phiDot, double phi)
{
return (1.*pow(a,5)*pow(k,2)*pow(m,2)*(0. + pow(H,4)*pow(k,6)*pow(phi,5)*(-4.5645066896828796e-12 + 2.921284281397043e-10*pow(phi,6)) - 0.19753086419753085*pow(H,5)*pow(k,6)*phiDot + pow(H,2)*pow(k,6)*pow(phi,5)*(-1.5215022298942926e-12 + 9.737614271323473e-11*pow(phi,6))*pow(phiDot,2) - 0.04938271604938271*H*pow(k,6)*pow(phiDot,5) + pow(H,3)*pow(k,6)*phiDot*(-3.8037555747357326e-12*pow(phi,4) + 5.355687849227911e-10*pow(phi,10) + 0.19753086419753085*pow(phiDot,2)) + pow(a,2)*H*pow(k,4)*(pow(H,5)*pow(phi,5)*(2.738704013809727e-11 - 1.7527705688382252e-9*pow(phi,6)) - 3.5555555555555554*pow(H,6)*phiDot - 0.2222222222222222*pow(m,2)*pow(phiDot,5) - 0.2222222222222222*pow(phiDot,7) + pow(H,4)*phiDot*(1.7777777777777777*pow(m,2) + 3.4233800172621586e-11*pow(phi,4) - 4.8201190643051195e-9*pow(phi,10) - 3.259259259259259*pow(phiDot,2)) + pow(H,3)*pow(phi,5)*(pow(m,2)*(-1.3693520069048635e-11 + 8.763852844191126e-10*pow(phi,6)) + (6.846760034524315e-12 - 4.3819264220955615e-10*pow(phi,6))*pow(phiDot,2)) + H*pow(phi,5)*pow(phiDot,2)*(pow(m,2)*(-6.846760034524317e-12 + 4.381926422095563e-10*pow(phi,6)) + (-5.7056333621035984e-12 + 3.651605351746303e-10*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*phiDot*(-2.2501499025772532e-21*pow(phi,16) + 7.20047968824721e-20*pow(phi,22) - 1.7116900086310793e-11*pow(phi,4)*pow(phiDot,2) + 1.1851851851851851*pow(phiDot,4) + pow(phi,10)*(1.757929611388479e-23 + 2.4100595321525597e-9*pow(phiDot,2)) + pow(m,2)*(-1.7116900086310793e-11*pow(phi,4) + 2.4100595321525597e-9*pow(phi,10) + 1.037037037037037*pow(phiDot,2)))) + pow(a,6)*pow(m,2)*phiDot*(pow(H,7)*pow(phi,4)*(-5.1350700258932385e-11 + 7.23017859645768e-9*pow(phi,6)) + pow(H,6)*pow(phi,5)*(5.106053163907578e-27 - 3.26787402490085e-25*pow(phi,6))*phiDot + pow(m,2)*pow(phi,5)*(-4.2792250215776983e-13 + 2.738704013809727e-11*pow(phi,6))*pow(phiDot,5) + pow(H,4)*pow(phi,5)*phiDot*(pow(m,2)*(1.0270140051786475e-11 - 6.572889633143344e-10*pow(phi,6)) + (5.106053163907578e-27 - 3.26787402490085e-25*pow(phi,6))*pow(phiDot,2)) + pow(H,2)*pow(phi,5)*phiDot*(pow(m,4)*(-5.135070025893238e-12 + 3.2864448165716724e-10*pow(phi,6)) + pow(m,2)*(-8.5584500431554e-13 + 5.477408027619456e-11*pow(phi,6))*pow(phiDot,2) + (-1.2765132909768945e-27 + 8.169685062252125e-26*pow(phi,6))*pow(phiDot,4)) + pow(H,5)*(3.3752248538658787e-21*pow(phi,16) - 1.0800719532370812e-19*pow(phi,22) + 5.990915030208778e-11*pow(phi,4)*pow(phiDot,2) + pow(m,2)*(5.1350700258932385e-11*pow(phi,4) - 7.230178596457678e-9*pow(phi,10) - 2.*pow(phiDot,2)) + pow(phi,10)*(-2.6368944170827177e-23 - 8.435208362533959e-9*pow(phiDot,2))) + H*(-0.16666666666666666*pow(m,4)*pow(phiDot,4) + pow(m,2)*pow(phiDot,2)*(1.6876124269329397e-21*pow(phi,16) - 5.400359766185407e-20*pow(phi,22) + 2.139612510788849e-12*pow(phi,4)*pow(phiDot,2) - 0.05555555555555555*pow(phiDot,4) + pow(phi,10)*(-1.3184472085413592e-23 - 3.0125744151906997e-10*pow(phiDot,2))) + pow(phi,4)*pow(phiDot,4)*(8.438062134664699e-22*pow(phi,12) - 2.7001798830927036e-20*pow(phi,18) + 2.139612510788849e-12*pow(phiDot,2) + pow(phi,6)*(-6.592236042706796e-24 - 3.0125744151906997e-10*pow(phiDot,2)))) + pow(H,3)*(pow(m,4)*(-1.2837675064733096e-11*pow(phi,4) + 1.8075446491144196e-9*pow(phi,10) + 1.*pow(phiDot,2)) + pow(phi,4)*pow(phiDot,2)*(-3.3752248538658787e-21*pow(phi,12) + 1.0800719532370812e-19*pow(phi,18) - 2.1396125107888493e-11*pow(phiDot,2) + pow(phi,6)*(2.6368944170827177e-23 + 3.0125744151906994e-9*pow(phiDot,2))) + pow(m,2)*(-1.6876124269329393e-21*pow(phi,16) + 5.400359766185406e-20*pow(phi,22) - 2.995457515104389e-11*pow(phi,4)*pow(phiDot,2) + 0.6666666666666666*pow(phiDot,4) + pow(phi,10)*(1.3184472085413589e-23 + 4.217604181266979e-9*pow(phiDot,2))))) + pow(a,4)*pow(k,2)*(pow(H,8)*pow(phi,5)*(-2.738704013809727e-11 + 1.7527705688382252e-9*pow(phi,6)) + 10.666666666666666*pow(H,9)*phiDot + pow(m,2)*pow(phi,5)*(-2.8528166810517997e-13 + 1.8258026758731518e-11*pow(phi,6))*pow(phiDot,6) + pow(H,7)*phiDot*(-11.555555555555555*pow(m,2) - 6.846760034524317e-11*pow(phi,4) + 9.640238128610239e-9*pow(phi,10) - 7.111111111111111*pow(phiDot,2)) + pow(H,6)*pow(phi,5)*(pow(m,2)*(3.423380017262159e-11 - 2.190963211047782e-9*pow(phi,6)) + (1.5318159491722734e-26 - 9.80362207470255e-25*pow(phi,6))*pow(phiDot,2)) + pow(H,4)*pow(phi,5)*(pow(m,4)*(-1.027014005178648e-11 + 6.572889633143347e-10*pow(phi,6)) + pow(m,2)*(1.0270140051786472e-11 - 6.572889633143342e-10*pow(phi,6))*pow(phiDot,2) + (2.0540280103572953e-11 - 1.314577926628669e-9*pow(phi,6))*pow(phiDot,4)) + pow(H,2)*pow(phi,5)*pow(phiDot,2)*(pow(m,4)*(-1.0270140051786476e-11 + 6.572889633143345e-10*pow(phi,6)) + pow(m,2)*(-1.3122956732838275e-11 + 8.398692309016496e-10*pow(phi,6))*pow(phiDot,2) + (-6.846760034524317e-12 + 4.381926422095563e-10*pow(phi,6))*pow(phiDot,4)) + pow(H,5)*phiDot*(3.111111111111111*pow(m,4) + pow(phiDot,2)*(6.846760034524317e-11*pow(phi,4) - 9.640238128610239e-9*pow(phi,10) - 1.7777777777777777*pow(phiDot,2)) + pow(m,2)*(8.558450043155397e-11*pow(phi,4) - 1.2050297660762798e-8*pow(phi,10) - 0.7407407407407407*pow(phiDot,2))) + H*(-0.3333333333333333*pow(m,4)*pow(phiDot,5) - 0.2222222222222222*pow(phiDot,9) + pow(m,2)*pow(phiDot,3)*(1.1250749512886266e-21*pow(phi,16) - 3.600239844123605e-20*pow(phi,22) + 1.4264083405258996e-12*pow(phi,4)*pow(phiDot,2) - 0.5555555555555556*pow(phiDot,4) + pow(phi,10)*(-8.789648056942395e-24 - 2.0083829434604663e-10*pow(phiDot,2)))) + pow(H,3)*phiDot*(pow(phiDot,4)*(-1.7116900086310793e-11*pow(phi,4) + 2.4100595321525597e-9*pow(phi,10) + 1.7777777777777777*pow(phiDot,2)) + pow(m,4)*(-2.5675350129466193e-11*pow(phi,4) + 3.615089298228839e-9*pow(phi,10) + 1.7777777777777777*pow(phiDot,2)) + pow(m,2)*(-4.500299805154506e-21*pow(phi,16) + 1.4400959376494418e-19*pow(phi,22) - 4.564506689682878e-11*pow(phi,4)*pow(phiDot,2) + 3.7777777777777777*pow(phiDot,4) + pow(phi,10)*(3.5158592227769576e-23 + 6.426825419073492e-9*pow(phiDot,2)))))))/pow(0.4444444444444444*pow(H,2)*pow(k,4) + pow(a,2)*pow(H,2)*pow(k,2)*(-2.6666666666666665*pow(H,2) + 1.3333333333333333*pow(m,2) + 1.3333333333333333*pow(phiDot,2)) + pow(a,4)*pow(m,2)*(-2.*pow(H,4) - 0.16666666666666666*pow(phiDot,4) + pow(H,2)*(1.*pow(m,2) + 1.3333333333333333*pow(phiDot,2))),2);
}


MinimalScalarEqn::MinimalScalarEqn(double k_, double m_, const ContextForModeEqn &context) :
  k(k_),
  m(m_),
  phi(boost::math::interpolators::quintic_hermite(context.phi)),
  H(boost::math::interpolators::cubic_hermite(context.H)),
  logaOvera0(boost::math::interpolators::cubic_hermite(context.logaOvera0)),
  logaEnd(context.logaEnd) {}


void MinimalScalarEqn::operator()(const NumVec &x, NumVec &dxdt, const double t) const
{
  double a_t = exp(logaOvera0(t) - logaEnd);
  double H_t = H(t);
  double phi_t = phi(t);
  double phiDot_t = phi.prime(t);
    
  double Kphi = computeKphi(a_t, H_t, k, m, phiDot_t, phi_t);
  double KB = computeKB(a_t, H_t, k, m, phiDot_t, phi_t);
  double Mphi = computeMphi(a_t, H_t, k, m, phiDot_t, phi_t);
  double MB = computeMB(a_t, H_t, k, m, phiDot_t, phi_t);
  double L2 = computeL2(a_t, H_t, k, m, phiDot_t, phi_t);
  double L1 = computeL1(a_t, H_t, k, m, phiDot_t, phi_t);
  double L0 = computeL0(a_t, H_t, k, m, phiDot_t, phi_t);
  double DKphi = computeDKphi(a_t, H_t, k, m, phiDot_t, phi_t);
  double DKB = computeDKB(a_t, H_t, k, m, phiDot_t, phi_t);
  double DL2 = computeDL2(a_t, H_t, k, m, phiDot_t, phi_t);
  double DL1 = computeDL1(a_t, H_t, k, m, phiDot_t, phi_t);

  double denom = 4 * KB * Kphi - L2 * L2;
    
  // vector x is of the form (Re varphi, Re varphi', Re B, Re B', Im varphi, Im varphi', Im B, Im B')
  dxdt[0] = x[1];
  dxdt[1] = ((-L0*L2 + 4*KB*Mphi + L2*DL1) * x[0] +
	     (L1*L2 - 4*KB*DKphi + L2*DL2) * x[1] +
	     (2*KB*L0 - 2*L2*MB) * x[2] +
	     2 * (L2*DKB + KB*(L1-DL2)) * x[3]) / denom;
  dxdt[2] = x[3];
  dxdt[3] = ((-2*L2*Mphi + 2*Kphi*(L0-DL1)) * x[0] +
	     (2*L2*DKphi - 2*Kphi*(L1+DL2)) * x[1] +
	     (-L0*L2 + 4*Kphi*MB) * x[2] +
	     (-L1*L2 - 4*Kphi*DKB + L2*DL2) * x[3]) / denom;

  dxdt[4] = x[5];
  dxdt[5] = ((-L0*L2 + 4*KB*Mphi + L2*DL1) * x[4] +
	     (L1*L2 - 4*KB*DKphi + L2*DL2) * x[5] +
	     (2*KB*L0 - 2*L2*MB) * x[6] +
	     2 * (L2*DKB + KB*(L1-DL2)) * x[7]) / denom;
  dxdt[6] = x[7];
  dxdt[7] = ((-2*L2*Mphi + 2*Kphi*(L0-DL1)) * x[4] +
	     (2*L2*DKphi - 2*Kphi*(L1+DL2)) * x[5] +
	     (-L0*L2 + 4*Kphi*MB) * x[6] +
	     (-L1*L2 - 4*Kphi*DKB + L2*DL2) * x[7]) / denom;
}

NumVec solve_minimal_scalar_eqn(double k, double m, const ContextForModeEqn &context)
{
  NumVec x = compute_initial_condition_for_minimal_scalar_eqn(k, m, context);
  
  auto stepper = boost::numeric::odeint::make_controlled<boost::numeric::odeint::runge_kutta_dopri5<NumVec>>(1.0e-15, 1.0e-9);
  auto mode_eqn = MinimalScalarEqn(k, m, context);
  double tInit = context.compute_tInit(k, m);

  boost::numeric::odeint::integrate_adaptive(stepper, mode_eqn, x, tInit, context.T, 1.0);
  //boost::numeric::odeint::integrate_adaptive(stepper, mode_eqn, x, tInit, 10 * context.tEnd, 1.0);
  return x;
}

NumVec compute_initial_condition_for_minimal_scalar_eqn(double k, double m, const ContextForModeEqn &context)
{
  double tInit = context.compute_tInit(k, m);
  double a_tInit = exp(context.logaOvera0(tInit) - context.logaEnd);
  double phi_tInit = context.phi(tInit);
  double phiDot_tInit = context.phi.prime(tInit);
  double H_tInit = context.H(tInit);
  
  double Kphi = computeKphi(a_tInit, H_tInit, k, m, phiDot_tInit, phi_tInit);
  double KB = computeKB(a_tInit, H_tInit, k, m, phiDot_tInit, phi_tInit);
  double DKphi = computeDKphi(a_tInit, H_tInit, k, m, phiDot_tInit, phi_tInit);
  double DKB = computeDKB(a_tInit, H_tInit, k, m, phiDot_tInit, phi_tInit);
  
  std::complex hankel_val_0 = boost::math::cyl_hankel_1(0.0, k / (a_tInit * H_tInit));
  std::complex hankel_val_1 = boost::math::cyl_hankel_1(1.0, k / (a_tInit * H_tInit));
  
  std::complex varphi = sqrt(M_PI / 2) * hankel_val_0 / (2 * sqrt(H_tInit * Kphi));
  std::complex Dvarphi = - sqrt(M_PI / 2) * (- 2 * k * hankel_val_1 * Kphi + a_tInit * hankel_val_0 * DKphi) / (4 * a_tInit * sqrt(H_tInit) * pow(Kphi, 1.5));
  std::complex B = sqrt(M_PI / 2) * hankel_val_0 / (2 * sqrt(H_tInit * KB));
  std::complex DB = - sqrt(M_PI / 2) * (- 2 * k * hankel_val_1 * KB + a_tInit * hankel_val_0 * DKB) / (4 * a_tInit * sqrt(H_tInit) * pow(KB, 1.5));
  
  NumVec x(8);
  x[0] = varphi.real();
  x[1] = Dvarphi.real();
  x[2] = B.real();
  x[3] = DB.real();
  x[4] = varphi.imag();
  x[5] = Dvarphi.imag();
  x[6] = B.imag();
  x[7] = DB.imag();
  
  return x;
}
